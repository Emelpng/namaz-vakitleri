<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TÃ¼rkiye Namaz Vakitleri</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Tranquil Dawn (Shades of blue and grey) -->
    <!-- Application Structure Plan: Uygulama, ana baÅŸlÄ±k, ÅŸehir seÃ§imi iÃ§in bir dropdown menÃ¼, seÃ§ilen ÅŸehrin mevcut namaz vakitlerini gÃ¶steren merkezi bir panel ve gÃ¼nÃ¼n diÄŸer vakitlerini listeyen alt panellerden oluÅŸan basit ve sezgisel bir yapÄ±ya sahiptir. Bu yapÄ±, kullanÄ±cÄ±larÄ±n ana iÅŸlevi (namaz vakitlerini gÃ¶rmek) hÄ±zlÄ± ve kolay bir ÅŸekilde gerÃ§ekleÅŸtirmesini saÄŸlar. BÃ¶lÃ¼mleme, en Ã¶nemli bilginin (gÃ¼ncel vakitler) hemen gÃ¶rÃ¼lebilir olmasÄ±nÄ± ve daha az Ã¶ncelikli bilgilerin (diÄŸer vakitler) dÃ¼zenli bir ÅŸekilde sunulmasÄ±nÄ± amaÃ§lar. -->
    <!-- Visualization & Content Choices: 
        - Namaz Vakitleri -> Hedef: HÄ±zlÄ± bilgi eriÅŸimi -> YÃ¶ntem: Merkezi bir panelde bÃ¼yÃ¼k fontlarla gÃ¶sterim -> EtkileÅŸim: Åžehir seÃ§imi ile verilerin gÃ¼ncellenmesi -> GerekÃ§e: En Ã¶nemli bilginin hemen gÃ¶ze Ã§arpmasÄ± hedeflenmiÅŸtir.
        - DiÄŸer Vakitler Listesi -> Hedef: KapsamlÄ± bilgi sunmak -> YÃ¶ntem: Basit liste formatÄ± -> EtkileÅŸim: Åžehir seÃ§imine gÃ¶re listeyi gÃ¼ncelleme -> GerekÃ§e: Ek verileri dÃ¼zenli ve okunaklÄ± bir ÅŸekilde sunar.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F8FAFC; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 flex flex-col min-h-screen">

    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4 flex flex-col sm:flex-row justify-between items-center">
            <h1 class="text-3xl font-extrabold text-blue-600 mb-2 sm:mb-0">TÃ¼rkiye Namaz Vakitleri</h1>
            <div class="flex items-center space-x-2">
                <label for="city-select" class="font-medium text-slate-600">Åžehir SeÃ§in:</label>
                <select id="city-select" class="p-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors cursor-pointer">
                    <option value="istanbul">Ä°stanbul</option>
                    <option value="ankara">Ankara</option>
                    <option value="izmir">Ä°zmir</option>
                    <option value="bursa">Bursa</option>
                    <option value="adana">Adana</option>
                    <option value="antalya">Antalya</option>
                    <option value="konya">Konya</option>
                    <option value="samsun">Samsun</option>
                    <option value="diyarbakir">DiyarbakÄ±r</option>
                    <option value="erzurum">Erzurum</option>
                </select>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8 flex-grow">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <div class="lg:col-span-2">
                <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-slate-200">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="city-display" class="text-3xl font-bold text-blue-800">Ä°stanbul</h2>
                        <div id="date-display" class="text-xl font-medium text-slate-500"></div>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-6 text-center">
                        <div class="bg-blue-50 p-4 rounded-xl shadow-inner border border-blue-100">
                            <p class="text-lg text-slate-600">Ä°msak</p>
                            <p id="imsak-time" class="text-3xl md:text-4xl font-extrabold text-blue-700 mt-1">05:15</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-xl shadow-inner border border-blue-100">
                            <p class="text-lg text-slate-600">GÃ¼neÅŸ</p>
                            <p id="gunes-time" class="text-3xl md:text-4xl font-extrabold text-blue-700 mt-1">06:45</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-xl shadow-inner border border-blue-100">
                            <p class="text-lg text-slate-600">Ã–ÄŸle</p>
                            <p id="ogle-time" class="text-3xl md:text-4xl font-extrabold text-blue-700 mt-1">13:15</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-xl shadow-inner border border-blue-100">
                            <p class="text-lg text-slate-600">Ä°kindi</p>
                            <p id="ikindi-time" class="text-3xl md:text-4xl font-extrabold text-blue-700 mt-1">17:15</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-xl shadow-inner border border-blue-100">
                            <p class="text-lg text-slate-600">AkÅŸam</p>
                            <p id="aksam-time" class="text-3xl md:text-4xl font-extrabold text-blue-700 mt-1">20:00</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-xl shadow-inner border border-blue-100">
                            <p class="text-lg text-slate-600">YatsÄ±</p>
                            <p id="yatsi-time" class="text-3xl md:text-4xl font-extrabold text-blue-700 mt-1">21:30</p>
                        </div>
                    </div>
                </div>
                
                <!-- Gemini API ile eklenen yeni kÄ±sÄ±m -->
                <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-slate-200 mt-8">
                    <h3 class="text-2xl font-bold text-blue-800 mb-4">Manevi Bir SÃ¶z</h3>
                    <div id="gemini-content-container" class="flex flex-col space-y-4">
                        <button id="get-message-btn" class="bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors shadow-lg">
                            Ä°lham Veren Bir SÃ¶z AlÄ±n âœ¨
                        </button>
                        
                        <div id="loading-indicator" class="hidden text-center text-slate-500">
                            YÃ¼kleniyor...
                        </div>
                        
                        <div id="message-display" class="hidden p-4 bg-slate-50 rounded-lg border border-slate-200">
                            <p id="message-text" class="text-md text-slate-700 leading-relaxed"></p>
                            <div class="mt-4 flex space-x-2">
                                <button id="play-audio-btn" class="bg-slate-200 text-slate-800 font-semibold py-2 px-4 rounded-lg hover:bg-slate-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                                    Sesi Oynat ðŸ”Š
                                </button>
                                <audio id="audio-player" class="hidden"></audio>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="lg:col-span-1">
                <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="text-2xl font-bold text-blue-800 mb-4">Gelecek GÃ¼nler</h3>
                    <div id="next-days-list" class="space-y-4">
                        
                    </div>
                </div>
            </div>
            
        </div>
    </main>

    <footer class="bg-white shadow-sm mt-8">
        <div class="container mx-auto p-4 text-center text-slate-500">
            <p>&copy; 2025 Namaz Vakitleri UygulamasÄ±. TÃ¼m haklarÄ± saklÄ±dÄ±r.</p>
        </div>
    </footer>

    <script>
        const prayerTimesData = {
            istanbul: [
                { date: 'BugÃ¼n', imsak: '05:15', gunes: '06:45', ogle: '13:15', ikindi: '17:15', aksam: '20:00', yatsi: '21:30' },
                { date: 'YarÄ±n', imsak: '05:14', gunes: '06:44', ogle: '13:15', ikindi: '17:16', aksam: '20:01', yatsi: '21:31' },
                { date: '2 GÃ¼n Sonra', imsak: '05:13', gunes: '06:43', ogle: '13:14', ikindi: '17:17', aksam: '20:02', yatsi: '21:32' },
            ],
            ankara: [
                { date: 'BugÃ¼n', imsak: '05:00', gunes: '06:30', ogle: '13:00', ikindi: '17:00', aksam: '19:45', yatsi: '21:15' },
                { date: 'YarÄ±n', imsak: '04:59', gunes: '06:29', ogle: '13:00', ikindi: '17:01', aksam: '19:46', yatsi: '21:16' },
                { date: '2 GÃ¼n Sonra', imsak: '04:58', gunes: '06:28', ogle: '12:59', ikindi: '17:02', aksam: '19:47', yatsi: '21:17' },
            ],
            izmir: [
                { date: 'BugÃ¼n', imsak: '05:30', gunes: '07:00', ogle: '13:30', ikindi: '17:30', aksam: '20:15', yatsi: '21:45' },
                { date: 'YarÄ±n', imsak: '05:29', gunes: '06:59', ogle: '13:29', ikindi: '17:31', aksam: '20:16', yatsi: '21:46' },
                { date: '2 GÃ¼n Sonra', imsak: '05:28', gunes: '06:58', ogle: '13:28', ikindi: '17:32', aksam: '20:17', yatsi: '21:47' },
            ],
            bursa: [
                { date: 'BugÃ¼n', imsak: '05:20', gunes: '06:50', ogle: '13:20', ikindi: '17:20', aksam: '20:05', yatsi: '21:35' },
                { date: 'YarÄ±n', imsak: '05:19', gunes: '06:49', ogle: '13:20', ikindi: '17:21', aksam: '20:06', yatsi: '21:36' },
                { date: '2 GÃ¼n Sonra', imsak: '05:18', gunes: '06:48', ogle: '13:19', ikindi: '17:22', aksam: '20:07', yatsi: '21:37' },
            ],
            adana: [
                { date: 'BugÃ¼n', imsak: '04:45', gunes: '06:15', ogle: '12:45', ikindi: '16:45', aksam: '19:30', yatsi: '21:00' },
                { date: 'YarÄ±n', imsak: '04:44', gunes: '06:14', ogle: '12:45', ikindi: '16:46', aksam: '19:31', yatsi: '21:01' },
                { date: '2 GÃ¼n Sonra', imsak: '04:43', gunes: '06:13', ogle: '12:44', ikindi: '16:47', aksam: '19:32', yatsi: '21:02' },
            ],
            antalya: [
                { date: 'BugÃ¼n', imsak: '05:25', gunes: '06:55', ogle: '13:25', ikindi: '17:25', aksam: '20:10', yatsi: '21:40' },
                { date: 'YarÄ±n', imsak: '05:24', gunes: '06:54', ogle: '13:24', ikindi: '17:26', aksam: '20:11', yatsi: '21:41' },
                { date: '2 GÃ¼n Sonra', imsak: '05:23', gunes: '06:53', ogle: '13:23', ikindi: '17:27', aksam: '20:12', yatsi: '21:42' },
            ],
            konya: [
                { date: 'BugÃ¼n', imsak: '05:10', gunes: '06:40', ogle: '13:10', ikindi: '17:10', aksam: '19:55', yatsi: '21:25' },
                { date: 'YarÄ±n', imsak: '05:09', gunes: '06:39', ogle: '13:10', ikindi: '17:11', aksam: '19:56', yatsi: '21:26' },
                { date: '2 GÃ¼n Sonra', imsak: '05:08', gunes: '06:38', ogle: '13:09', ikindi: '17:12', aksam: '19:57', yatsi: '21:27' },
            ],
            samsun: [
                { date: 'BugÃ¼n', imsak: '04:50', gunes: '06:20', ogle: '12:50', ikindi: '16:50', aksam: '19:35', yatsi: '21:05' },
                { date: 'YarÄ±n', imsak: '04:49', gunes: '06:19', ogle: '12:50', ikindi: '16:51', aksam: '19:36', yatsi: '21:06' },
                { date: '2 GÃ¼n Sonra', imsak: '04:48', gunes: '06:18', ogle: '12:49', ikindi: '16:52', aksam: '19:37', yatsi: '21:07' },
            ],
            diyarbakir: [
                { date: 'BugÃ¼n', imsak: '04:35', gunes: '06:05', ogle: '12:35', ikindi: '16:35', aksam: '19:20', yatsi: '20:50' },
                { date: 'YarÄ±n', imsak: '04:34', gunes: '06:04', ogle: '12:35', ikindi: '16:36', aksam: '19:21', yatsi: '20:51' },
                { date: '2 GÃ¼n Sonra', imsak: '04:33', gunes: '06:03', ogle: '12:34', ikindi: '16:37', aksam: '19:22', yatsi: '20:52' },
            ],
            erzurum: [
                { date: 'BugÃ¼n', imsak: '04:20', gunes: '05:50', ogle: '12:20', ikindi: '16:20', aksam: '19:05', yatsi: '20:35' },
                { date: 'YarÄ±n', imsak: '04:19', gunes: '05:49', ogle: '12:20', ikindi: '16:21', aksam: '19:06', yatsi: '20:36' },
                { date: '2 GÃ¼n Sonra', imsak: '04:18', gunes: '05:48', ogle: '12:19', ikindi: '16:22', aksam: '19:07', yatsi: '20:37' },
            ]
        };

        const citySelect = document.getElementById('city-select');
        const cityDisplay = document.getElementById('city-display');
        const dateDisplay = document.getElementById('date-display');
        const imsakTime = document.getElementById('imsak-time');
        const gunesTime = document.getElementById('gunes-time');
        const ogleTime = document.getElementById('ogle-time');
        const ikindiTime = document.getElementById('ikindi-time');
        const aksamTime = document.getElementById('aksam-time');
        const yatsiTime = document.getElementById('yatsi-time');
        const nextDaysList = document.getElementById('next-days-list');
        
        // Gemini API iÃ§in yeni DOM elementleri
        const getMessageBtn = document.getElementById('get-message-btn');
        const messageDisplay = document.getElementById('message-display');
        const messageText = document.getElementById('message-text');
        const loadingIndicator = document.getElementById('loading-indicator');
        const playAudioBtn = document.getElementById('play-audio-btn');
        const audioPlayer = document.getElementById('audio-player');
        
        // API anahtarÄ±nÄ± tanÄ±mlÄ±yoruz.
        const apiKey = "";
        
        // Namaz vakitlerini gÃ¼ncelleyen fonksiyon
        function formatDate(date) {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('tr-TR', options);
        }

        function updatePrayerTimes(city) {
            const data = prayerTimesData[city];
            if (!data) return;

            const todayData = data[0];
            const currentDate = new Date();
            dateDisplay.textContent = formatDate(currentDate);

            cityDisplay.textContent = city.charAt(0).toUpperCase() + city.slice(1);
            imsakTime.textContent = todayData.imsak;
            gunesTime.textContent = todayData.gunes;
            ogleTime.textContent = todayData.ogle;
            ikindiTime.textContent = todayData.ikindi;
            aksamTime.textContent = todayData.aksam;
            yatsiTime.textContent = todayData.yatsi;

            nextDaysList.innerHTML = '';
            for (let i = 1; i < data.length; i++) {
                const dayData = data[i];
                const dayElement = document.createElement('div');
                dayElement.className = 'flex justify-between items-center p-4 bg-slate-50 rounded-lg border border-slate-200';
                dayElement.innerHTML = `
                    <div class="font-medium text-slate-600">${dayData.date}</div>
                    <div class="flex space-x-2 text-sm text-slate-500">
                        <span>Ä°msak: ${dayData.imsak}</span>
                        <span>GÃ¼neÅŸ: ${dayData.gunes}</span>
                        <span>Ã–ÄŸle: ${dayData.ogle}</span>
                        <span>Ä°kindi: ${dayData.ikindi}</span>
                        <span>AkÅŸam: ${dayData.aksam}</span>
                        <span>YatsÄ±: ${dayData.yatsi}</span>
                    </div>
                `;
                nextDaysList.appendChild(dayElement);
            }
        }

        // Gemini API - Metin oluÅŸturma fonksiyonu
        async function getInspirationalMessage() {
            loadingIndicator.classList.remove('hidden');
            messageDisplay.classList.add('hidden');
            getMessageBtn.disabled = true;

            const currentCity = citySelect.options[citySelect.selectedIndex].text;
            const currentPrayerTime = 'BugÃ¼n'; // Basitlik iÃ§in sadece bugÃ¼nÃ¼n vakti
            const prompt = `BugÃ¼nkÃ¼ ${currentCity} ÅŸehrinin namaz vakitleri iÃ§in, Ä°slami Ã¶ÄŸretilere, huzura ve duaya vurgu yapan, kÄ±sa (en fazla 30 kelime) ve ilham verici bir sÃ¶z veya dua cÃ¼mlesi oluÅŸtur. Ã–rneÄŸin, "GÃ¼neÅŸin doÄŸuÅŸuyla birlikte, yeni bir gÃ¼ne ÅŸÃ¼kÃ¼rle baÅŸla." gibi.`;
            
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            
            const payload = { contents: chatHistory };
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    messageText.textContent = text;
                    messageDisplay.classList.remove('hidden');
                } else {
                    console.error('API yanÄ±tÄ± beklendiÄŸi gibi deÄŸil:', result);
                    messageText.textContent = 'Bir hata oluÅŸtu, lÃ¼tfen tekrar deneyin.';
                    messageDisplay.classList.remove('hidden');
                }
            } catch (error) {
                console.error('API Ã§aÄŸrÄ±sÄ± sÄ±rasÄ±nda bir hata oluÅŸtu:', error);
                messageText.textContent = 'Bir hata oluÅŸtu, lÃ¼tfen internet baÄŸlantÄ±nÄ±zÄ± kontrol edin.';
                messageDisplay.classList.remove('hidden');
            } finally {
                loadingIndicator.classList.add('hidden');
                getMessageBtn.disabled = false;
            }
        }

        // Gemini API - TTS (Metinden Sese) fonksiyonu
        async function playAudio(text) {
            playAudioBtn.disabled = true;
            playAudioBtn.textContent = 'YÃ¼kleniyor...';

            const payload = {
                contents: [{
                    parts: [{ text: `NeÅŸeli bir tonla sÃ¶yle: ${text}` }]
                }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: {
                        voiceConfig: {
                            prebuiltVoiceConfig: { voiceName: "Algieba" }
                        }
                    }
                },
                model: "gemini-2.5-flash-preview-tts"
            };

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();
                const part = result?.candidates?.[0]?.content?.parts?.[0];
                const audioData = part?.inlineData?.data;
                const mimeType = part?.inlineData?.mimeType;

                if (audioData && mimeType && mimeType.startsWith("audio/")) {
                    const sampleRate = parseInt(mimeType.match(/rate=(\d+)/)[1], 10);
                    const pcmData = base64ToArrayBuffer(audioData);
                    const pcm16 = new Int16Array(pcmData);
                    const wavBlob = pcmToWav(pcm16, sampleRate);
                    const audioUrl = URL.createObjectURL(wavBlob);
                    
                    audioPlayer.src = audioUrl;
                    audioPlayer.play();
                } else {
                    console.error('API ses verisi dÃ¶ndÃ¼rmedi:', result);
                    alert('Ses oynatÄ±lamÄ±yor. LÃ¼tfen tekrar deneyin.');
                }

            } catch (error) {
                console.error('TTS API Ã§aÄŸrÄ±sÄ± sÄ±rasÄ±nda bir hata oluÅŸtu:', error);
                alert('Ses oynatÄ±lamÄ±yor. Ä°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin.');
            } finally {
                playAudioBtn.disabled = false;
                playAudioBtn.textContent = 'Sesi Oynat ï¿½';
            }
        }
        
        // Base64'ten ArrayBuffer'a dÃ¶nÃ¼ÅŸtÃ¼rme fonksiyonu
        function base64ToArrayBuffer(base64) {
            const binaryString = window.atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }

        // PCM verisini WAV formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼rme fonksiyonu
        function pcmToWav(pcmData, sampleRate) {
            const buffer = new ArrayBuffer(44 + pcmData.length * 2);
            const view = new DataView(buffer);
            
            // RIFF header
            writeString(view, 0, 'RIFF');
            view.setUint32(4, 36 + pcmData.length * 2, true);
            writeString(view, 8, 'WAVE');
            
            // FMT sub-chunk
            writeString(view, 12, 'fmt ');
            view.setUint32(16, 16, true);
            view.setUint16(20, 1, true); // Linear PCM
            view.setUint16(22, 1, true); // Mono
            view.setUint32(24, sampleRate, true);
            view.setUint32(28, sampleRate * 2, true);
            view.setUint16(32, 2, true);
            view.setUint16(34, 16, true);
            
            // DATA sub-chunk
            writeString(view, 36, 'data');
            view.setUint32(40, pcmData.length * 2, true);
            
            // Write PCM data
            let offset = 44;
            for (let i = 0; i < pcmData.length; i++, offset += 2) {
                view.setInt16(offset, pcmData[i], true);
            }
            
            return new Blob([view], { type: 'audio/wav' });
        }

        function writeString(view, offset, string) {
            for (let i = 0; i < string.length; i++) {
                view.setUint8(offset + i, string.charCodeAt(i));
            }
        }


        // Event Listener'lar
        citySelect.addEventListener('change', (event) => {
            updatePrayerTimes(event.target.value);
            // Åžehir deÄŸiÅŸince AI iÃ§eriÄŸini sÄ±fÄ±rla
            messageText.textContent = '';
            messageDisplay.classList.add('hidden');
        });

        getMessageBtn.addEventListener('click', getInspirationalMessage);
        
        playAudioBtn.addEventListener('click', () => {
            const textToSpeak = messageText.textContent;
            if (textToSpeak) {
                playAudio(textToSpeak);
            }
        });
        
        // Uygulama yÃ¼klendiÄŸinde varsayÄ±lan ÅŸehri gÃ¶ster
        updatePrayerTimes('istanbul');
    </script>
</body>
</html>
